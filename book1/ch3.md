第三章 函数

从代码结构来看，层层函数调用就是一个后进先出的过程。与数据结构中的入栈出栈完全一致。这种调用方式称为递归调用。
所以非常适合用栈来管理函数的局部变量等数据。

汇编语言中，函数调用的过程是这样的：
调用函数时，先将参数压栈，然后跳转到函数的入口地址。函数执行完毕后，返回值放在寄存器中，然后将栈中的参数弹出，最后跳转回调用函数的地址。

用汇编代码来看，函数调用的过程是这样的：
```asm
push 参数1
push 参数2
call 函数地址
add esp, 8
```
意思为：将参数1和参数2压栈，然后调用函数，函数执行完毕后，将栈中的参数弹出。
函数返回的过程是这样的：
```asm
mov eax, 返回值
ret
```
这里的`ret`指令会将栈中的参数弹出，然后跳转回调用函数的地址。

3.1 栈帧

函数调用时，会在栈上分配一块内存，用来存放函数的局部变量、参数、返回地址等信息。这块内存称为栈帧。

3.1.1 栈帧的组成

栈帧布局在编译阶段确定。依据函数代码。


![ch3-3.1.1.png](img/ch3-3.1.1.png)


